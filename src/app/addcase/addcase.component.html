<div class="w-full px-[5%]"><app-pubmed #pmidChild></app-pubmed>
<app-addages (ageEntries)="handleAgeList($event)"></app-addages>
<div class="w-full mx-auto p-4">
  <div *ngIf="showTextArea">
  <label class="block mb-2 text-sm font-medium text-gray-700">
      Paste clinical text
  </label>
  <div class="flex flex-col items-start">
    <textarea
      [(ngModel)]="pastedText"
      rows="25"
      placeholder="Paste here with ctrl-V..."
      class="w-[100%] border-4 border-gray-400 rounded-md p-3 text-sm font-mono resize-y focus:outline-none focus:border-blue-500"
    ></textarea>

    <button
      (click)="doHpoTextMining()"
      class="mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition"
    >Run HPO Text Mining</button>
</div>
</div>
</div>
<div *ngIf="showDataEntryArea">




<div class="whitespace-pre-wrap text-sm font-mono mb-4"
  [innerHTML]="htmlData"
  ></div>
  (mouseup)="handleTextSelection($event)"
<!-- <div *ngIf="selectedText" class="mt-2">
  <span class="text-green-600 font-bold">Selected: "{{ selectedText }}"</span>
  <button (click)="annotateSelectedText()" class="ml-2 px-3 py-1 bg-blue-500 text-white rounded">Annotate</button>
</div> -->

<div
  *ngIf="showAnnotationPopup"
  class="absolute bg-white border rounded shadow p-2"
  [style.top.px]="popupY"
  [style.left.px]="popupX">
  <div class="text-sm font-medium mb-1">Annotate selection</div>
  <button class="block w-full text-left" (click)="annotateSelection('P32Y')">Age: P32Y</button>
  <button class="block w-full text-left" (click)="annotateSelection('CONGENITAL')">Age: Congenital</button>
  <button class="block w-full text-left" (click)="closePopup()">Cancel</button>
</div>

<button
    (click)="resetWindow()"
    class="mt-3 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition"
  >
    Reset
  </button>


<!-- <p *ngIf="pastedText">Original text: {{ pastedText }}</p> -->

<!-- Display the table if jsonData is available -->
<table *ngIf="jsonData.length">
  <thead>
    <tr>
      <!-- Create table headers dynamically -->
      <th *ngFor="let key of getObjectKeys(jsonData[0])">{{ key }}</th>
    </tr>
  </thead>
  <tbody>
    <tr *ngFor="let item of jsonData; let i = index" [ngClass]="{'highlight': item.status === 'active'}">
      <td *ngFor="let key of getObjectKeys(item)">
        {{ item[key] }}
      </td>
      <!-- New Column with Radio Buttons and Input -->
      <td>
        <div *ngFor="let option of predefinedOptions">
          <input type="radio" [name]="'option_' + i" [(ngModel)]="selectedOptions[i]" [value]="option">
          {{ option }}
        </div>

        <!-- Input Field for Custom Option -->
        <input type="text" [(ngModel)]="customOptions[i]" placeholder="Enter custom option">
        <button (click)="addCustomOption(i)">Add</button>
      </td>
    </tr>
  </tbody>
</table>

<p>Selected Options: {{ selectedOptions | json }}</p>


</div>
</div>